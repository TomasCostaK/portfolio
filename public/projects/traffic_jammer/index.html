<!doctype html><html lang=en dir=auto><head><script src="/portfolio/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=portfolio/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>TrafficJammer, an app to closely monitor a city's traffic (University Project) | TomasCostaK</title>
<meta name=keywords content="Software Engineering,University"><meta name=description content="TrafficJammer, an app to closely monitor a city's traffic"><meta name=author content="TomasCostaK"><link rel=canonical href=http://localhost:1313/portfolio/projects/traffic_jammer/><link crossorigin=anonymous href=/portfolio/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/portfolio/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/portfolio/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/portfolio/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/portfolio/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/portfolio/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/portfolio/projects/traffic_jammer/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/portfolio/ accesskey=h title="TomasCostaK (Alt + H)">TomasCostaK</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/portfolio/blogs/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/portfolio/projects/ title=Projects><span>Projects</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">TrafficJammer, an app to closely monitor a city's traffic (University Project)</h1><div class=post-description>TrafficJammer, an app to closely monitor a city's traffic</div><div class=post-meta><span title='2024-07-19 22:23:24 +0100 WEST'>July 19, 2024</span>&nbsp;·&nbsp;TomasCostaK</div></header><figure class=entry-cover><img loading=eager src=http://localhost:1313/portfolio/covers/traffic_jam.jpg alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#relevant-links aria-label="Relevant Links">Relevant Links</a></li><li><a href=#users-stories-that-lead-to-the-development-of-this-project aria-label="Users stories that lead to the development of this project">Users stories that lead to the development of this project</a></li><li><a href=#requirements aria-label=Requirements>Requirements</a></li><li><a href=#architecture aria-label=Architecture>Architecture</a></li><li><a href=#server aria-label=Server>Server</a><ul><li><a href=#why-django aria-label="Why Django?">Why Django?</a></li><li><a href=#why-rabbitmq aria-label="Why RabbitMQ?">Why RabbitMQ?</a></li><li><a href=#why-sql-and-why-not aria-label="Why SQL and why not!">Why SQL and why not!</a></li><li><a href=#processing-and-bizz-logic aria-label="Processing and Bizz logic">Processing and Bizz logic</a></li><li><a href=#how-the-database-is-modeled aria-label="How the database is modeled">How the database is modeled</a></li></ul></li><li><a href=#web-application aria-label="Web Application">Web Application</a><ul><li><a href=#trafficweb-view-traffic aria-label="TrafficWeb (View Traffic)">TrafficWeb (View Traffic)</a></li><li><a href=#dashboard-view-traffic-data aria-label="Dashboard (View traffic data)">Dashboard (View traffic data)</a></li><li><a href=#administration aria-label=Administration>Administration</a></li></ul></li><li><a href=#mobile-application aria-label="Mobile Application">Mobile Application</a></li><li><a href=#sensordata aria-label=SensorData​>SensorData​</a><ul><li><a href=#city-creation aria-label="City creation">City creation</a></li><li><a href=#sensor-virtualization aria-label="Sensor Virtualization">Sensor Virtualization</a><ul><li><a href=#file-doeverythingpy aria-label="File doEverything.py">File doEverything.py</a></li><li><a href=#file-sendpy aria-label="File Send.py">File Send.py</a></li><li><a href=#file-receivepy aria-label="File Receive.py">File Receive.py</a></li></ul></li></ul></li><li><a href=#devops-with-git-and-docker aria-label="DevOps with Git and Docker">DevOps with Git and Docker</a><ul><li><a href=#the-structure-of-the-repository aria-label="The Structure of the Repository">The Structure of the Repository</a></li><li><a href=#building-the-environment-with-docker aria-label="Building the Environment With Docker">Building the Environment With Docker</a></li><li><a href=#continuous-integration-and-deployment-with-gitlab aria-label="Continuous Integration and Deployment with GitLab">Continuous Integration and Deployment with GitLab</a></li></ul></li></ul></div></details></div><div class=post-content><p>Traffic Jammer is a web application that allows you to view traffic close to you (as a regular user) and manage your city through a very detailed dashboard (administrator). Users with special access (admins) can also create new streets on each city. Features include:</p><ul><li>Simple interface for visualizing the traffic around you, don&rsquo;t waste time in traffic anymore.</li><li>Relevant statistics concerning your city&rsquo;s roads including: roadbloack, traffic jams , police location and car crashes.</li><li>Track specific cars in a given city.</li><li>Beautiful and easily usable interface both for clients and administration.</li></ul><h2 id=relevant-links>Relevant Links<a hidden class=anchor aria-hidden=true href=#relevant-links>#</a></h2><ul><li><a href=https://gitlab.com/myiesgroup/iesproject_trafficjammer/blob/master/Reports/RestApi.md>API Documentation</a></li><li><a href=https://gitlab.com/myiesgroup/iesproject_trafficjammer/tree/master/Prototype>Prototype</a></li></ul><h2 id=users-stories-that-lead-to-the-development-of-this-project>Users stories that lead to the development of this project<a hidden class=anchor aria-hidden=true href=#users-stories-that-lead-to-the-development-of-this-project>#</a></h2><ul><li><p>John is a university student residing in Ilhavo currently studying in Aveiro. Before leaving home he wants to know what road to take and to that he needs to know what roads are blocked today, if there are any accidents in his usual route, how is the transit in the roads leading to his university. He needs all this information so that he may be aware of the time he will take to reach class and what path to take to be more effecient.</p></li><li><p>Barbara is a office worker for Esgueira Town Hall. She was assigned the job of understanding what are the critical streets in her city in order to try and approve changes that will fix these situations. She wants to have statistical data from years back to the current days , and to be able to handle this data in different ways, for example to check if the accidents happen every day or if they happen more on Mondays and Fridays or if a street was having a lot of road blocks something is not working properly and should have been fixed in a single roadblock and not over many roadblocks.</p></li></ul><h2 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h2><p>The basic requirements for the implementation of this project were:</p><ul><li>Distributed generation of data stream</li><li>Data publishing using message oriented protocol</li><li>Long term storage</li><li>Central processing</li><li>Service API</li><li>Web Portal</li></ul><h2 id=architecture>Architecture<a hidden class=anchor aria-hidden=true href=#architecture>#</a></h2><p><img loading=lazy src=https://i.imgur.com/JzFFOet.png alt=Architecture></p><h2 id=server>Server<a hidden class=anchor aria-hidden=true href=#server>#</a></h2><h3 id=why-django>Why Django?<a hidden class=anchor aria-hidden=true href=#why-django>#</a></h3><pre><code>1. Django in a overall aspect is simpler and has the least ceremony which leads to a more productive environment.
2. Django, unlike, Spring has less mental overhead, there are no Beans,XML configurations, dependencies to be injected... This makes Django easier to understand and to start developing ,this helps the programmer enjoy the project working on.
3. Django Admin is a really good aspect and feature that makes it easier to understand the environment and see what is going on.
4. Django is in 979 company stacks while Spring is only in 316 stacks this makes it that programmers are more inclined to choose Django, and with more people working on it comes more ways to find out your problems and more well-rounded solutions to common problems. Django also has one of the best all around documentation.
5- Starting a prototype and evolving from a small concept to a big fully functionaly product is simple and can be done even without any pre-defined structure.
6- Django guides us throughout the project, by default it creates the basic needs for everything to work and we just scale it from there.
7- Django isn't as capable in terms of big enterprise projects as Spring, but due to our small reach requirements Django was already a tool with more capabilities than we needed so it was a no brainer to use a tool that was harder to work with for this job.
</code></pre><h3 id=why-rabbitmq>Why RabbitMQ?<a hidden class=anchor aria-hidden=true href=#why-rabbitmq>#</a></h3><pre><code>1.RabbitMQ is a simple and effective message queueing broker.
2.RabbitMQ supports a wide range of communication protocols.
3.RabbitMQ has a Python Client (Pyka) which goes with what we wanted to do, which was simple and effective developing. 
4.RabbitMQ can handle 2305843009213693951 bytes (from the documentantion), which was more than enought for the the amount of data we were generating  (around 1000,if not more, producer inputs every second).
</code></pre><p>​</p><h3 id=why-sql-and-why-not>Why SQL and why not!<a hidden class=anchor aria-hidden=true href=#why-sql-and-why-not>#</a></h3><pre><code>1. We all have a background working with SQL and the relational model and it's tools seemed to be the right option for the job.
2.In the aftermath, SQL became a bottleneck, the amount of data we were inserting was so massive SQL wasn't able to handle it properly, to avoid swapping to a better database model (because of the implications this would bring to the development process) we created some workarounds (aggregation of requests and lowering the thresholds).
1. We have a lot of incoming data, but almost none of it happens to change the same values in the database, everything we save is more in line with a log based structured.
</code></pre><h3 id=processing-and-bizz-logic>Processing and Bizz logic<a hidden class=anchor aria-hidden=true href=#processing-and-bizz-logic>#</a></h3><pre><code>The server processes the flowing sensor data and works with it accordingly.
The main logic is that we receive incoming traffic, police notifications, roadblock updates, visibility changes and accidents and save it in order to give the exact response based on what a client wants to see.
If a client wants to see all the data of a city (in the current moment), it requests it, the server having the knowledge of everything that is going on in each road/section takes the data and gives an ouput based on that, being it that the state of a street is never calculated client side, the server has the logic and works accordinly. So, having this in mind, the server can send various states of traffic (Normal,Medium,Congested,Blocked), being it that it depends on how much traffic there is, if there is any roadblock in the section and how much visibility the section has (if it is foggy we threshold for traffic becomes lower, meaning that a road will become congested easier).
If the client wants to see statistics about a certain road the server doesn't have it stored as it is,he receives the request does some work (aggregations,time conditions,week days...) and based on that he send the response back to the client.
The same logic applies to the other requests, we initially receive raw data, we handle it, we save it in a certan way and when requested for it we have processes that send an answer that suits what the client is asking for.
If the client , or even a faulty sensor,for some reason ends up sending a bad request or data that doesn't fit the system we handle it appropriately and send a request that let's them know what the internal error was.
</code></pre><h3 id=how-the-database-is-modeled>How the database is modeled<a hidden class=anchor aria-hidden=true href=#how-the-database-is-modeled>#</a></h3><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph LR
A[Street]; B[Sections]; C[Accident]; D[Transit] ; E[Roadblock]; F[Cars]
A -- Composed of --&gt; B;
B -- Has --&gt; C
B -- Has --&gt; D
B -- Has --&gt; E
B -- Has --&gt; F
B -- Connects --&gt; B
</code></pre><p>​</p><ul><li><strong>Rua is a table with the attributes:</strong><ul><li>Name of street,</li><li>beginning coordinates,</li><li>ending coordinates,</li><li>length,</li><li>city ,</li><li>autogenerated long ID number for primary key;</li></ul></li><li><strong>Trecho is a weak entity:</strong><ul><li>Boolean value for increasing (True) vs decreasing(False) to distinguish directions</li><li>ID of street</li><li>Beginning coordinates</li><li>Ending coordinates</li><li>Number of cars</li><li>Number of accidents</li><li>Current Visibility (0-100)</li><li>Roadblock (True or False)</li><li>Police (True or False)</li><li>Prime key: id+bool+beginning</li></ul></li><li><strong>Acidente is basically a logger entity:</strong><ul><li>Date of accident</li><li>Coordinates for the accident (the exact place)</li><li>The section where it happened</li></ul></li><li><strong>Congestao is another logger:</strong><ul><li>Date of congestion</li><li>The section where congestion happened</li></ul></li><li><strong>Blocked is another looger entity:</strong><ul><li>Start date</li><li>End date (starts being null, only updated when roadblock ends)</li><li>Section that is / was blocked</li></ul></li><li><strong>Cars is a tracker of which car and where they are:</strong><ul><li>License Plate</li><li>Current section</li></ul></li></ul><h2 id=web-application>Web Application<a hidden class=anchor aria-hidden=true href=#web-application>#</a></h2><pre><code>For the web development we chose to go with React since one of our developers already had some experience with the technology and there are plenty of modules that could help us achieve what we wanted to do.  
</code></pre><h3 id=trafficweb-view-traffic>TrafficWeb (View Traffic)<a hidden class=anchor aria-hidden=true href=#trafficweb-view-traffic>#</a></h3><pre><code>One of the biggest challenges we faced while going for basic HTML with JavaScript was that the Canvas element weren't enough, since with canvas we couldn't draw dynamic lines and once we updated the colors, all the canvas would change. 
So we came up with a crafty solution: Using a library called: Konva.js (1)
we were able to draw multiples lines (with customizable parameters) in a personalized canvas. This allowed us to draw dynamic maps according to the information we got from the server, and repopulate the canvas every X seconds so we could see *real time* changes to the map.
The use of async with the nature of message protocols and it's quirks (time it takes for a message to go , be processed and answered) we can have a somewhat weird interaction with the map, being it that if we change city often the webclient can receive an older request while already being in a new city therefore displaying the wrong map. 
</code></pre><p>(1) -> <a href=https://konvajs.org/>Konva.js</a></p><p>Keypoints for implementation:</p><ul><li>Dynamic map creation using an algorithm</li><li>Real time map view</li><li>Tracking specific cars</li><li>Allow the user to search multiple cities</li></ul><h3 id=dashboard-view-traffic-data>Dashboard (View traffic data)<a hidden class=anchor aria-hidden=true href=#dashboard-view-traffic-data>#</a></h3><pre><code>For the dashboard we can have several options that help us with viewing relevant data concerning each city's streets. This data is viewed through a typical display of number, but also through a chart made using [ChartJS](https://www.chartjs.org/)  
</code></pre><p>These parameters are customizable:</p><ul><li>City</li><li>Street</li><li>Start Date</li><li>End Date</li><li>Week day</li></ul><h3 id=administration>Administration<a hidden class=anchor aria-hidden=true href=#administration>#</a></h3><p>In the administration page we are able to create a new street, if it passes all needed requirements, which are:</p><ul><li><p>Being in an available city</p></li><li><p>Having a unique name</p></li><li><p>Having beginning coordinates differ from the ending</p><p>In the future, we intend for an administrator to also be capable of doing some editing in the sections of the streets, e.g. directly tell the system if a road is blocked, or if there is police activity. These ideas ,for future work, should in real world cenario be provided in real time by the sensors and that was the reason we focused more on the main goals we proposed and left out this part.</p></li></ul><h2 id=mobile-application>Mobile Application<a hidden class=anchor aria-hidden=true href=#mobile-application>#</a></h2><pre><code>We inteded to create a mobile application that would display the maps and would send push notifications if the traffic nearby was rapidly increasing. But, the core of the project was made using a library that wasn't available in ReactNative, and so, we had to pushback our changes in mobile and focus on the website.
</code></pre><h2 id=sensordata>SensorData​<a hidden class=anchor aria-hidden=true href=#sensordata>#</a></h2><h3 id=city-creation>City creation<a hidden class=anchor aria-hidden=true href=#city-creation>#</a></h3><p>​
In order to watch this project working we needed to introduce cities to the DataBase.<br>A set of streets belonging to a city was generated with a Python script and fed to the API. After the insertion of the data, a set of Sections was returned that will be used later on.<br>​</p><h3 id=sensor-virtualization>Sensor Virtualization<a hidden class=anchor aria-hidden=true href=#sensor-virtualization>#</a></h3><p>​
The main goal with this part of the data generation is to sucessfully replace real sensors by a script that generates data in a similar,close to real,way.<br>We could opt to create a set of static messages to recreate the same scenario every time but we decided to go for a more bold move and let the messages be created randomly by a somewhat consistent virtual sensor.<br>Initially, our intention was have a raspberry generating full time data for us, but since we could not get one in time and probably wasn&rsquo;t worth it (due to the low computacional capacity), we decided to run this sensors in our own PCs.<br>​
The previously returned sections are divisions of the generated streets.
These sections are required for the next step (virtualization of sensor data). It was needed to run a few more python scripts on this sections to put them in the desired way, for example find all the connections between Sections so that in the simulation, cars would go from one section to another without magicaly appearing in the order side of the map. Note as well that this responsability should not be from the server, as this consistency in sensor virtualization would not be a concern in a real word project.</p><h4 id=file-doeverythingpy>File doEverything.py<a hidden class=anchor aria-hidden=true href=#file-doeverythingpy>#</a></h4><p><strong>Usage</strong> ​</p><blockquote><p>python3 doEverything.py fileContainingStreets CityName<br>​</p></blockquote><pre><code>Will send the server the information required to create a city as well as processing the returning data in the desired way. The result, a file named CityName.txt wich would be fed to the sensors script (this file contains the connections of every section to facilitate consistency).  
​
</code></pre><h4 id=file-sendpy>File Send.py<a hidden class=anchor aria-hidden=true href=#file-sendpy>#</a></h4><p>There are two ways of running send:</p><ul><li>Normal distribution across all streets with routing enabled (1)</li><li>Start the population of a street - Insertion of 20 to 70 cars per street (2)</li></ul><p>​<strong>USAGE</strong></p><blockquote><p>python3 send.py ConnectionsFile(retured by doEverything.py) (1)</p></blockquote><blockquote><p>python3 send.py ConnectionsFile populate (2)</p></blockquote><p>Send.py is the main script of data generation.
It is a producer sensor that generates various types of messages and stores them in RabbitMQ queues.
The data generation follows the required parameters for each type of message specified in the API Documentation.<br>In total,we have 5 different sensors,each one with different responsibilities:<br>​</p><ul><li><p>Car movements -> Adds cars or removes cars from sections, being it that cars can move from one street to the other if these streets connect.</p></li><li><p>Police Location -> Adds and removes police to and from some streets</p></li><li><p>Road blocked -> Adds and removes roadblocks (anything that impedes traffic)</p></li><li><p>Accident Location -> Adds and/or removes accidents from a section, adds the specific coordinates in a given section</p></li><li><p>Visibility -> Alters the visibility of the some sections, being it that less visibility makes it harder to drive
​</p><p>As said before, these messages are stored in 2 RabbitMQ queues (Car movements gets a queue of his own due to high loads of data generation,this is done in order to unsynchronization issues in the other messages).<br>Without getting in unecessary details, this script uses one of the API GET methods to have an idea of the internal state of the data in the DataBase, and then, from there continuosly generates messages to get the simulation running.<br>Note, that the information about cars and sections is only asked once, and from there the script keeps a representation of the data so that the server doesn&rsquo;t need to perform unecessary work, this is because of how these setups/sensors would behave in the real world as mentioned above.<br>All the other messages are not very costly so before creating them the server gives information about police locations, etc.
​</p></li></ul><p>The messages are json Objects, for example:
​</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;insert&#34;</span>, <span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#ae81ff>5</span>, <span style=color:#f92672>&#34;plate&#34;</span>:<span style=color:#e6db74>&#34;AL16PO&#34;</span>, <span style=color:#f92672>&#34;city&#34;</span>:<span style=color:#e6db74>&#34;Ilhavo&#34;</span>}
</span></span><span style=display:flex><span>{<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;visibility&#34;</span>, <span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#ae81ff>6</span>, <span style=color:#f92672>&#34;visibility&#34;</span>:<span style=color:#ae81ff>50</span>, <span style=color:#f92672>&#34;city&#34;</span>:<span style=color:#e6db74>&#34;Ilhavo&#34;</span>}
</span></span></code></pre></div><p>​</p><p>​</p><h4 id=file-receivepy>File Receive.py<a hidden class=anchor aria-hidden=true href=#file-receivepy>#</a></h4><p>​<strong>USAGE</strong></p><blockquote><p>python3 receive.py</p></blockquote><pre><code>Receive.py is the consumer of Rabbit-MQ and his target is to process and forward the sensor messages to the server using the API methods.  
Since the there are a lot of car movements messages and our group had issues with performance in early tests, this data is sent in *bulk mode* to the server to minimize the communication between this end of the queue and the server (100 messages are aggregated before they are sent to the server).The messages sent in these *bulk mode* maintain the order that they were generated in.
​
We can have has many sends running (1 for each city) as we want, but we only need one receive.
</code></pre><h2 id=devops-with-git-and-docker>DevOps with Git and Docker<a hidden class=anchor aria-hidden=true href=#devops-with-git-and-docker>#</a></h2><h3 id=the-structure-of-the-repository>The Structure of the Repository<a hidden class=anchor aria-hidden=true href=#the-structure-of-the-repository>#</a></h3><pre><code>In the beginning of the project, we assigned a part of the project for each person to work on. For the master branch not to be clouded with useless or non-functioning code, a branch was assigned to each job, for the frontend, backend and data generation. Some extra branches were created as the job required, for extra features or hotfixes to solve bugs in the code.
Furthermore, as the job went, we established tasks for each person to do in the Gitlab. Initially the simple, more general ones were assigned, and then each programmer would subdivide these features into subproblems they had to solve, noting down those smaller problems.
Finally, when it comes to finishing one of these subproblems, a merge request or pull request is issued to the DevOps master, who would then review the changes and approve the request if it came down to it. After the merges were done, the new code would be pushed. In the beginning these would be just standard, but after the CI/CD component was finished, these changes would pass a pipeline of deployment, seeing if it would run in the environment, and if any errors in compilation were raised.
</code></pre><h3 id=building-the-environment-with-docker>Building the Environment With Docker<a hidden class=anchor aria-hidden=true href=#building-the-environment-with-docker>#</a></h3><pre><code>To build the environment for the project, a different Dockerfile was made for each component, setting up the environment accordingly. For instance, the frontend was done with the React.js framework: using this framework means installing a lot of different dependencies and running different build commands for it to be officially running. Docker makes this a lot easier and automated.
Building from a local dockerfile makes it so that all dependencies, old and new, are installed properly every time we'd want to set up the environment; something that would regularly need a chain of bash commands to function, would now be done by simply building and running a docker image.
It also adds a needed level of abstraction to the project, which is important in terms of security. Even though we didn't go too overboard on this part of the project, building the environment from a docker and running that environment, is a way of sandboxing the project. So an attack on the system that could prove terrible if it was ran directly on the server, is a non-issue running on a Docker environment.
Now, building one Dockerfile makes one of the component's environment, but this project required more than just one Dockerfile. To automate this process of building all the Dockerfiles, we started by building a docker-compose file. This file would build all needed docker environment and assign them the respective ports. Building the environment for the project became two commands.
However, while this idea was good in theory, and it worked if done manually, it seemed to fall apart when trying to implement it from a pipeline for CI/CD, maybe due to other errors caused from inexperience.
</code></pre><h3 id=continuous-integration-and-deployment-with-gitlab>Continuous Integration and Deployment with GitLab<a hidden class=anchor aria-hidden=true href=#continuous-integration-and-deployment-with-gitlab>#</a></h3><pre><code>This component was, by far, the most troubling issue for an inexperienced DevOps Master. With no experience on the inner workings of the pipelines or how gitlab would implement the integration, a lot of time was spent just reading the official documentation and reading through different articles and tutorials.
In a nutshell, the CI/CD is done from a document in the root of the project. In the file, we specified two important stages: cleanup, where, if possible, you must clean up the docker images that may be running; and the deploy stage, where we deploy the needed environments.
In the side of the server, we added a gitlab runner, who is programmed to run the pipeline, deploying the website in the process. This runner is programmed to run all the jobs needed, and in order, so that there's no inconsistencies. As expected, if an error in the building occurs, the pipeline fails and the error is sent to the devops master.
To make things more foolproof, the jobs are designed to only work from the master branch, so that the runner doesn't run inconsistent code.</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/portfolio/tags/software-engineering/>Software Engineering</a></li><li><a href=http://localhost:1313/portfolio/tags/university/>University</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/portfolio/>TomasCostaK</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>